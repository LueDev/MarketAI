(MarketAI) luisjorge@Luis-MBP RF_multi_output % python backtest_rf_multi_output_rolling_predictions.py
Starting backtest...
Loaded model from models/rf_finance_historical.joblib
Test data aligned with model features. Dataset size: (12525, 25)
Backtesting for interval: 15 days...
Processing batch 1 from index 0 to 1000...
Processing batch 2 from index 1000 to 2000...
Processing batch 3 from index 2000 to 3000...
Processing batch 4 from index 3000 to 4000...
Processing batch 5 from index 4000 to 5000...
Processing batch 6 from index 5000 to 6000...
Processing batch 7 from index 6000 to 7000...
Processing batch 8 from index 7000 to 8000...
Processing batch 9 from index 8000 to 9000...
Processing batch 10 from index 9000 to 10000...
Processing batch 11 from index 10000 to 11000...
Processing batch 12 from index 11000 to 12000...
Processing batch 13 from index 12000 to 12510...
Interval 15 days: MSE=2763.007000, MAE=12.521042, R2=0.901089
Backtesting for interval: 30 days...
Processing batch 1 from index 0 to 1000...
Processing batch 2 from index 1000 to 2000...
Processing batch 3 from index 2000 to 3000...
Processing batch 4 from index 3000 to 4000...
Processing batch 5 from index 4000 to 5000...
Processing batch 6 from index 5000 to 6000...
Processing batch 7 from index 6000 to 7000...
Processing batch 8 from index 7000 to 8000...
Processing batch 9 from index 8000 to 9000...
Processing batch 10 from index 9000 to 10000...
Processing batch 11 from index 10000 to 11000...
Processing batch 12 from index 11000 to 12000...
Processing batch 13 from index 12000 to 12495...
Interval 30 days: MSE=5453.267136, MAE=20.660198, R2=0.805015
Backtesting for interval: 45 days...
Processing batch 1 from index 0 to 1000...
Processing batch 2 from index 1000 to 2000...
Processing batch 3 from index 2000 to 3000...
Processing batch 4 from index 3000 to 4000...
Processing batch 5 from index 4000 to 5000...
Processing batch 6 from index 5000 to 6000...
Processing batch 7 from index 6000 to 7000...
Processing batch 8 from index 7000 to 8000...
Processing batch 9 from index 8000 to 9000...
Processing batch 10 from index 9000 to 10000...
Processing batch 11 from index 10000 to 11000...
Processing batch 12 from index 11000 to 12000...
Processing batch 13 from index 12000 to 12480...
Interval 45 days: MSE=8039.792456, MAE=28.025175, R2=0.712876
Backtesting for interval: 60 days...
Processing batch 1 from index 0 to 1000...
Processing batch 2 from index 1000 to 2000...
Processing batch 3 from index 2000 to 3000...
Processing batch 4 from index 3000 to 4000...
Processing batch 5 from index 4000 to 5000...
Processing batch 6 from index 5000 to 6000...
Processing batch 7 from index 6000 to 7000...
Processing batch 8 from index 7000 to 8000...
Processing batch 9 from index 8000 to 9000...
Processing batch 10 from index 9000 to 10000...
Processing batch 11 from index 10000 to 11000...
Processing batch 12 from index 11000 to 12000...
Processing batch 13 from index 12000 to 12465...
Interval 60 days: MSE=10573.718490, MAE=34.983389, R2=0.622833
Backtesting for interval: 75 days...
Processing batch 1 from index 0 to 1000...
Processing batch 2 from index 1000 to 2000...
Processing batch 3 from index 2000 to 3000...
Processing batch 4 from index 3000 to 4000...
Processing batch 5 from index 4000 to 5000...
Processing batch 6 from index 5000 to 6000...
Processing batch 7 from index 6000 to 7000...
Processing batch 8 from index 7000 to 8000...
Processing batch 9 from index 8000 to 9000...
Processing batch 10 from index 9000 to 10000...
Processing batch 11 from index 10000 to 11000...
Processing batch 12 from index 11000 to 12000...
Processing batch 13 from index 12000 to 12450...
Interval 75 days: MSE=12897.883993, MAE=41.419590, R2=0.540476
Backtesting for interval: 90 days...
Processing batch 1 from index 0 to 1000...
Processing batch 2 from index 1000 to 2000...
Processing batch 3 from index 2000 to 3000...
Processing batch 4 from index 3000 to 4000...
Processing batch 5 from index 4000 to 5000...
Processing batch 6 from index 5000 to 6000...
Processing batch 7 from index 6000 to 7000...
Processing batch 8 from index 7000 to 8000...
Processing batch 9 from index 8000 to 9000...
Processing batch 10 from index 9000 to 10000...
Processing batch 11 from index 10000 to 11000...
Processing batch 12 from index 11000 to 12000...
Processing batch 13 from index 12000 to 12435...
Interval 90 days: MSE=15029.449202, MAE=46.955745, R2=0.465175
Backtesting for interval: 105 days...
Processing batch 1 from index 0 to 1000...
Processing batch 2 from index 1000 to 2000...
Processing batch 3 from index 2000 to 3000...
Processing batch 4 from index 3000 to 4000...
Processing batch 5 from index 4000 to 5000...
Processing batch 6 from index 5000 to 6000...
Processing batch 7 from index 6000 to 7000...
Processing batch 8 from index 7000 to 8000...
Processing batch 9 from index 8000 to 9000...
Processing batch 10 from index 9000 to 10000...
Processing batch 11 from index 10000 to 11000...
Processing batch 12 from index 11000 to 12000...
Processing batch 13 from index 12000 to 12420...
Interval 105 days: MSE=16970.103180, MAE=52.012755, R2=0.396845
Backtesting for interval: 120 days...
Processing batch 1 from index 0 to 1000...
Processing batch 2 from index 1000 to 2000...
Processing batch 3 from index 2000 to 3000...
Processing batch 4 from index 3000 to 4000...
Processing batch 5 from index 4000 to 5000...
Processing batch 6 from index 5000 to 6000...
Processing batch 7 from index 6000 to 7000...
Processing batch 8 from index 7000 to 8000...
Processing batch 9 from index 8000 to 9000...
Processing batch 10 from index 9000 to 10000...
Processing batch 11 from index 10000 to 11000...
Processing batch 12 from index 11000 to 12000...
Processing batch 13 from index 12000 to 12405...
Interval 120 days: MSE=18945.296469, MAE=57.897182, R2=0.327455
Backtest results:
Interval 15 days: {'MSE': 2763.0069995944245, 'MAE': 12.521042118165132, 'R2': 0.9010885065357471}
Interval 30 days: {'MSE': 5453.267135869303, 'MAE': 20.660198156431992, 'R2': 0.8050146811604716}
Interval 45 days: {'MSE': 8039.792456009781, 'MAE': 28.025174530368965, 'R2': 0.7128757241052698}
Interval 60 days: {'MSE': 10573.718489532925, 'MAE': 34.983388900079355, 'R2': 0.6228326858629459}
Interval 75 days: {'MSE': 12897.88399255312, 'MAE': 41.419589537986305, 'R2': 0.540476061885488}
Interval 90 days: {'MSE': 15029.449201866159, 'MAE': 46.95574496216423, 'R2': 0.46517549536530167}
Interval 105 days: {'MSE': 16970.103180392074, 'MAE': 52.0127546567721, 'R2': 0.39684523137204575}
Interval 120 days: {'MSE': 18945.296469238387, 'MAE': 57.897181526069154, 'R2': 0.3274550300934739}
Results saved to backtest_results.csv